FROM node:19-alpine

ARG NEXT_PUBLIC_SUPABASE_URL
ENV NEXT_PUBLIC_SUPABASE_URL ${NEXT_PUBLIC_SUPABASE_URL}
ARG NEXT_PUBLIC_SUPABASE_ANON_KEY
ENV NEXT_PUBLIC_SUPABASE_ANON_KEY ${NEXT_PUBLIC_SUPABASE_ANON_KEY}
ARG NEXT_PUBLIC_SUPERAGENT_API_URL
ENV NEXT_PUBLIC_SUPERAGENT_API_URL ${NEXT_PUBLIC_SUPERAGENT_API_URL}
ARG NEXT_PUBLIC_SUPABASE_STORAGE_NAME
ENV NEXT_PUBLIC_SUPABASE_STORAGE_NAME ${NEXT_PUBLIC_SUPABASE_STORAGE_NAME}

RUN mkdir -p /app
WORKDIR /app
COPY . .

RUN npm install
RUN npm run build

EXPOSE 3000
CMD ["npm", "start"]
